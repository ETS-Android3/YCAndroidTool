#### 目录介绍
- 01.性能问题分类
- 02.性能优化原则
- 03.性能优化方法
- 04.性能优化工具
- 05.掌握渲染问题
- 06.掌握内存问题
- 07.掌握功耗问题





### 01.性能问题分类
- 1、渲染问题：过度绘制、布局冗杂
- 2、内存问题：内存浪费（内存管理）、内存泄漏
- 3、功耗问题：耗电



### 02.性能优化原则
- 坚持性能测试（开发和测试同学的测试方法略有不同）：不要凭感觉去检测性能问题、评估性能优化的效果，应该保持足够多的测量，用数据说话（主要针对测试同学）。使用各种性能工具测试及快速定位问题（主要针对开发同学）。
- 使用低配置的设备：同样的程序，在低端配置的设备中，相同的问题会暴露得更为明显。
- 权衡利弊：在能够保证产品稳定、按时完成需求的前提下去做优化。



### 03.性能优化方法
- 了解问题（分为可感知和不可感知的性能问题）：对于性能问题来讲，这个步骤只适用于某些明显的性能问题，很多无法感知的性能问题需要通过工具定位。例如：内存泄漏、层级冗杂、过度绘制等无法感知。滑动卡顿是可以感知到的。
- 定位问题：通过工具检测、分析数据，定位在什么地方存在性能问题。
- 分析问题：找到问题后，分析针对这个问题该如何解决，确定解决方案。
- 解决问题：根据分析结果寻找解决方案。
- 验证问题：保证优化有效，没有产生新的问题，以及产品稳定性。



### 04.性能优化工具
- 1、手机开发者选项：调试GPU过度绘制、启用严格模式、显示CPU使用情况、GPU呈现模式分析、显示所有"应用程序无响应"。（小米手机开发开发者选项中名字）
- 2、IDE中：Android Studio，比如静态代码检测工具、Memory Monitor（内存）、CPU Monitor（CPU）、NetWork Monitor（网络）、GPU Monitor、Layout Inspector（布局）、Analyze APK等。
- 3、SDK中：sdk\tools，比如DDMS、HierarchyViewer、TraceView等。
- 4、第三方工具：MAT、LeakCanary（内存泄漏监控）、GT等。




### 05.掌握渲染问题
#### 5.1 渲染问题分析
- 先来看看造成应用UI卡顿的常见原因都有哪些？
    - 1、人为在UI线程中做轻微耗时操作，导致UI线程卡顿；
    - 2、布局Layout过于复杂，无法在16ms内完成渲染；
    - 3、同一时间动画执行的次数过多，导致CPU或GPU负载过重；
    - 4、View过度绘制，导致某些像素在同一帧时间内被绘制多次，从而使CPU或GPU负载过重；
    - 5、View频繁的触发measure、layout，导致measure、layout累计耗时过多及整个View频繁的重新渲染；
    - 6、内存频繁触发GC过多（同一帧中频繁创建内存），导致暂时阻塞渲染操作；
    - 7、冗余资源及逻辑等导致加载和执行缓慢；
    - 8、臭名昭著的ANR；
- 什么是丢帧现象
    - Android系统每隔16ms发出VSYNC信号（vertical synchronization --场扫描同步，场同步，垂直同步），触发对UI进行渲染，如果每次渲染都成功，这样就能够达到流畅的画面所需要的60fps，为了能够实现60fps，这意味着程序的大多数操作都必须在16ms（1000/60=16.67ms）内完成。
    - 如果你的某个操作花费时间是24ms，系统在得到VSYNC信号的时候就无法进行正常渲染，这样就发生了丢帧现象。那么用户在32ms内看到的会是同一帧画面。


#### 5.1 查看渲染工具
- GPU呈现模式分析（大致定位问题）
    - 开发者选项 — GPU呈现模式分析 — 选择“在屏幕上显示为条形图”











