#### 目录介绍
- 01.SDK相关



### 01.SDK相关
#### 1.1 配置中心以及灰度测试
- app必备工具之一，配置中心主要负责的就是动态化的配置，比如文本展示类似这些的。sdk提供方需要负责的是提供动态更新能力，这里有个差异化更新，只更新dif部分，还有就是流量优化等等需要开发同学考虑的。然后可以考虑下存储性能方面的提升等。
- 而abtest也是app必备工具之一了，动态的下发实验策略，之后开发同学可以切换实验的页面。另外主要需要考虑灰度结果计算，分桶以及版本过滤白名单等等。这里只是一个简单的介绍不展开，因为我只是一个使用方。



#### 1.2 调试组件
- 个人还是更推荐滴滴的Dokit，功能点比较多而且接入相对来说比较简单。
    - 而且提供了很多给开发同学定制的能力，可以在debug情况下增加很多业务相关的测试功能，方便测试同学，核心还是浮窗太方便了。
    - https://github.com/didi/DoraemonKit
- 当然很多实验性的预研功能等其实都可以直接接在这里，然后在测试环境下充分展开，之后在进行线上灰度方案。还有一些具有风险的hook操作，个人也比较建议放在debug组件上。


#### 1.3 性能监控框架
- 首先是异常崩溃方面的，另外则是性能监控方面的，但是他们整体是划分在一起的，都属于线上性能监控体系的。
- Crash相关的，可以从爱奇艺的xCrash学起。包含了崩溃日志，ANR以及native crash，因为版本适配的问题ANR在高版本上已经不是这么好捞了，还有就是native crash相关的。是一个非常牛逼的库了。
    - https://github.com/iqiyi/xCrash
- 线上的性能监控框架可以从腾讯的Matrix学起, Matrix首页上也有介绍，比如fps，卡顿，IO，电池，内存等等方面的监控。其中卡顿监控涉及到的就是方法前后插桩，同时要有函数的mapping表，插桩部分整体来说比较简单感觉。
    - https://github.com/Tencent/matrix
- 关于线上内存相关的，推荐各位可以学习下快手的koom, 对于hprof的压缩比例听说能达到70%，也能完成线上的数据回捞以及监控等等，是一个非常屌的框架。
    - https://github.com/KwaiAppTeam/KOOM
- 其实上述几个库都还是有一个本质相关的东西，那么就是plthook,这个上面三个库应该都有对其的使用，之前是爱奇艺的xhook，现在是字节的bhook, 这个大佬也是我的偶像之一了，非常离谱了算是。
    - https://github.com/iqiyi/xHook
    - https://github.com/bytedance/bhook
- Android 性能采集之Fps,Memory,Cpu 和 Android IO监控。
    - https://juejin.cn/post/6890754507639095303
    - https://juejin.cn/post/6900810600188739592


#### 1.4 基础网络组件
- 虽然核心可能还是三方网络库，但是因为基本所有公司都对网络方面有调整和改动，以及解析器等方面的优化，其实可以挖的东西也还是蛮多的。
- 应付面试的同学可以看看Android网络优化方案。当然还是要具体问题具体分析，毕竟头疼医头，脚疼医脚对吧。
    - https://juejin.cn/post/6896302142542315533


#### 1.5 埋点框架
其实这个应该要放在更前面一点的，数据上报数据分析啥的其实都还是蛮重要的。
这部分因为我完全没写过哦，所以我压根不咋会，但是如果你会的话，面试的时候展开说说，可以帮助你不少
另外还需要有线上的异常用户数据回捞系统，方便开发同学主动去把线上有异常的用户的日志给收集回来。
但是有些刁钻的页面曝光监控啦，自动化埋点啥的其实还是写过一点的，有兴趣的可以翻翻历史，还有github 上还有demo。
AndroidAutoTrack demo工程。
https://github.com/Leifzhang/AndroidAutoTrack



6. 启动相关



通过DAG(有向无环图)的方式将sdk的初始化拆解成一个个task，之后理顺依赖关系，让他们能按照固定的顺序向下执行。



核心需要处理的是依赖关系，比如说其实埋点库依赖于网络库初始化，然后APM相关的则依赖于埋点库和配置中心abtest等等，这样的依赖关系需要开发同学去理顺的。



另外就是把sdk的粒度打的细碎一点，更容易观察每个sdk任务的耗时情况，之后增加task阈值告警，超过某个加载速度就通知到相应的同学改一下。



多线程是能优化掉一部分，但是也需要避免频繁线程调度。还有就是我个人觉得这些启动相关的东西因为都无法使用sdk级别的灰度，所以改动最好慎重一点。出发点始终都是好的，但是还是结果导向吧。



启动优化的核心，我个人始终坚持的就是延迟才能优化。开发人员很难做到优化代码执行的复杂度，执行时间之类的。尽人事听天命，玄学代码。



7. 中间件(图片 日志 存储 基础信息)



这部分没啥，最好是对第三方库有一层隔离的思维，但是这个隔离也需要对应的同学对于程序设计方面有很好的思维，说起来简单，其实也蛮复杂的。



这里就不展开了，感觉面试也很少会问的很细。



8. 第三方sdk大杂烩（偏中台方向）



基本一个app现在都有啥分享啦，推送啦，支付啦，账号体系啦，webview，jsbridge等等服务于应用内的一些sdk，这些东西就比较偏向于业务。



有兴趣的可以看看之前写的两篇关于sdk设计相关的。



活学活用责任链 SDK开发的一点点心得 Android厂商推送Plugin化。

https://juejin.cn/post/6952870833761026079



9. 其他方面



大公司可能都会有些动态化方案的考虑，比如插件化啊动态化之类的。这部分在下确实不行，我就不展开了啊。



# 参考
    - https://mp.weixin.qq.com/s/gbHTA0YGrD3KJhf3zy8S6Q












